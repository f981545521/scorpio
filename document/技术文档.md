### 参考手册

#### Spring的事务与动态代理
https://www.cnblogs.com/qizhelongdeyang/p/12411576.html
http://www.itrensheng.com/archives/spring_transactional_uneffect

- SpringBoot2.x默认的代理模式设置成cglib代理
- 如果偏要springboot 走JDK动态代理，那么需要在application.properties里面配置
```
spring.aop.proxy-target-class=false
```

一旦使用了AOP（如：@Transactional， @Aspect），Spring就会创建其代理类。

Spring已经放弃了JDK动态代理，默认使用CGLIB。

![Proxy](images/JDK与CGLIB.png)
> 参考：https://blog.csdn.net/u011242657/article/details/99747011


#### Shiro的集成
Shiro是Apache下的一个开源项目。shiro属于轻量级框架，相对于SpringSecurity简单的多，也没有SpringSecurity那么复杂。
```
    <dependency>
        <groupId>org.apache.shiro</groupId>
        <artifactId>shiro-spring</artifactId>
        <version>1.4.0</version>
    </dependency>
```

##### shiro主要有三大功能模块：
1. Subject：主体，一般指用户。
2. SecurityManager：安全管理器，管理所有Subject，可以配合内部安全组件。
3. Realms：用于进行权限信息的验证，一般需要自己实现。

#### 关键点
1. 自定义Realm，在里面写登录方法，设置权限与角色。
2. CacheManager，shiro提供了基于内存的缓存，使用的是ConcurrentHashMap。也可以使用redis、j2cache第三方缓存。
3. 使用注解：判断拥有权限：`@RequiresPermissions("user:view")`，判断拥有角色：`@RequiresRoles("admin")`

> 参考：https://blog.csdn.net/bicheng4769/article/details/86668209
